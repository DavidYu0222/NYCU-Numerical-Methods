M = [-1, 3,-3, 1;
      3,-6, 3, 0;
     -3, 0, 3, 0;
      1, 4, 1, 0];

X = [1.3, 1.3, 1.3, 1.3;
     2.5, 2.5, 2.5, 2.5;
     3.1, 3.1, 3.1, 3.1;
     4.7, 4.7, 4.7, 4.7];

Y = [0.2, 0.4 ,0.5, 0.7;
     0.2, 0.4 ,0.5, 0.7;
     0.2, 0.4 ,0.5, 0.7;
     0.2, 0.4 ,0.5, 0.7];

Z = [2.521 2.792 2.949 3.314;
     3.721 3.992 4.149 4.514;
     4.321 4.592 4.749 5.114;
     5.921 6.192 6.349 6.714];

Cx = 1/36 * M * X * (M');
vec_u = Cx(:,4)';
vec_u(4) = vec_u(4) - 2.8;
u_roots = roots(vec_u);
u = u_roots(imag(u_roots) == 0);

u_v = [u^3, u^2, u, 1];

Cy = 1/36 * M * Y * (M');
vec_v = Cy(4,:);
vec_v(4) = vec_v(4) - 0.54;
v_roots = roots(vec_v);
v = v_roots(imag(v_roots) == 0);

v_v = [v^3; v^2; v; 1];

test_x = 1/36 * u_v * M * X * (M') * v_v; 
test_y = 1/36 * u_v * M * Y * (M') * v_v; 

% z(u, v) = 1/36 * u'MZM'v
z = 1/36 * u_v * M * Z * (M') * v_v; 
disp(['z = ', num2str(z)]);
